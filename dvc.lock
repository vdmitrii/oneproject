schema: '2.0'
stages:
  select_region:
    cmd: python src/data/get_data.py data/raw/data.xlsx data/processed/data.csv
    deps:
    - path: data/raw/data.xlsx
      hash: md5
      md5: e8c921732ee342abef98b3456c11aa42
      size: 179766
    - path: src/data/get_data.py
      hash: md5
      md5: 2ef0f813d7c696be3dc9c3fb2a1ec36c
      size: 447
    params:
      params.yaml:
        data.DATA_PATH: data/processed/data.csv
        data.RAW_DATA_PATH: data/raw/data.xlsx
    outs:
    - path: data/processed/data.csv
      hash: md5
      md5: ec64ad25e1205056f8c68166c0b95b65
      size: 186413
  clean_data:
    cmd: python src/data/clean_data.py data/processed/data.csv data/processed/data_cleaned.csv
    deps:
    - path: data/processed/data.csv
      hash: md5
      md5: 088b01eca4b5846dc866f1fe37ec130f
      size: 176070
    - path: src/data/clean_data.py
      hash: md5
      md5: 41ef4c29f3fdb6c765f9b264e5876414
      size: 522
    params:
      params.yaml:
        data.CLEANED_DATA_PATH: data/processed/data_cleaned.csv
        data.DATA_PATH: data/processed/data.csv
    outs:
    - path: data/processed/data_cleaned.csv
      hash: md5
      md5: e6b595a68ca30b80b104ca9408312931
      size: 196820
  get_data:
    cmd: python src/data/get_data.py data/raw/data.xlsx data/processed/data.csv
    deps:
    - path: data/raw/data.xlsx
      hash: md5
      md5: e8c921732ee342abef98b3456c11aa42
      size: 179766
    - path: src/data/get_data.py
      hash: md5
      md5: 1cd279107351f880262e6030a1cb19f5
      size: 430
    params:
      params.yaml:
        data.DATA_PATH: data/processed/data.csv
        data.RAW_DATA_PATH: data/raw/data.xlsx
    outs:
    - path: data/processed/data.csv
      hash: md5
      md5: 088b01eca4b5846dc866f1fe37ec130f
      size: 176070
  add_features:
    cmd: python src/features/add_features.py data/processed/data_cleaned.csv data/processed/data_featured.csv
    deps:
    - path: data/processed/data_cleaned.csv
      hash: md5
      md5: e6b595a68ca30b80b104ca9408312931
      size: 196820
    - path: src/features/add_features.py
      hash: md5
      md5: b899854b2db68c12af89a893c1344647
      size: 1688
    params:
      params.yaml:
        data.CLEANED_DATA_PATH: data/processed/data_cleaned.csv
        data.FEATURED_DATA_PATH: data/processed/data_featured.csv
    outs:
    - path: data/processed/data_featured.csv
      hash: md5
      md5: 064aecb84770f406fbd91533c0239c65
      size: 698399
  prepare_datasets:
    cmd: python src/data/prepare_datasets.py data/processed/data_featured.csv data/processed/train.csv
      data/processed/test.csv
    deps:
    - path: data/processed/data_featured.csv
      hash: md5
      md5: 064aecb84770f406fbd91533c0239c65
      size: 698399
    - path: src/data/prepare_datasets.py
      hash: md5
      md5: 2ded259e8b2a8f312c7214aee516fdd7
      size: 869
    params:
      params.yaml:
        data.FEATURED_DATA_PATH: data/processed/data_featured.csv
        data.TEST_FILE_PATH: data/processed/test.csv
        data.TRAIN_FILE_PATH: data/processed/train.csv
        prep.split_date: '2023-06-01'
    outs:
    - path: data/processed/test.csv
      hash: md5
      md5: b596df3a148e2e28dea84a61b2923249
      size: 134399
    - path: data/processed/train.csv
      hash: md5
      md5: e014dc4178783e15ec19480e4a65b91d
      size: 536867
  train:
    cmd: python src/models/train.py data/processed/train.csv models/catboost_model.cbm
    deps:
    - path: data/processed/train.csv
      hash: md5
      md5: e014dc4178783e15ec19480e4a65b91d
      size: 536867
    - path: src/models/train.py
      hash: md5
      md5: a6ebc20cb8eb52f4303f52254dbad085
      size: 1074
    params:
      params.yaml:
        data.MODEL_FILE_PATH: models/catboost_model.cbm
        data.TRAIN_FILE_PATH: data/processed/train.csv
    outs:
    - path: models/catboost_model.cbm
      hash: md5
      md5: 5b2c1f302f28704c3836825b36a2acaf
      size: 1086816
  predict:
    cmd: python src/models/predict.py data/processed/test.csv models/catboost_model.cbm
      reports/scores.csv
    deps:
    - path: models/catboost_model.cbm
      hash: md5
      md5: 5b2c1f302f28704c3836825b36a2acaf
      size: 1086816
    - path: src/models/predict.py
      hash: md5
      md5: d2f94e13c4a1619418ed49ebe3ec72fd
      size: 931
    params:
      params.yaml:
        data.MODEL_FILE_PATH: models/catboost_model.cbm
        data.SCORE_FILE_PATH: reports/scores.csv
        data.TEST_FILE_PATH: data/processed/test.csv
    outs:
    - path: reports/scores.csv
      hash: md5
      md5: 0a5da269b6c0d20eb8057156d940343c
      size: 47
